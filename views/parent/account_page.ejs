<%- include("../component/header") %> 
<%- include("../component/navbar") %> 


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account info</title>



</head>
<style>
 

.col-md-9{
    display:none ;
}  

#link a:hover{
    background-color: rgb(199, 176, 247);
    color: rgb(194, 194, 194);
   

}
#link a:hover i{
    background-color: rgb(199, 176, 247);
    color: blueviolet;
 
}


.bg-active{
  background-color: rgb(199, 176, 247);
    color: blueviolet;
 
}
</style>


<body>


<br>


<% if( typeof msg!=typeof alifn && msg.length>0) {%>

  <%-include("../component/toast_live") %> 

     <% } else { %>
       <%=null %> 
       <% } %> 


       <%-include("../component/modal_danger") %> 

       <%-include("../component/toast_alive") %> 


<div class="row mt-2">

                <button id="menuButton" class=" btn w-100 bg-dark text-light d-block d-md-none">&#9776;</button>
                
                <div class="col-md-3 ml-20 d-none d-md-block" id="menuItems">
                    <div class="card" id="link">
                        <div class="card-body">
                        <div class="card-title text-muted">ACCOUNT SETTINGS</div>
                                
                                    <a id="personalInfo" class="nav-link text-dark " href="#personalInfo"><i class="fa-sharp fa-solid fa-gear m-2"></i>Personal info</a>
                                    <a id="security" class="nav-link text-dark" href="#security"><i class="fa-sharp fa-solid fa-user m-2"></i>Security</a>
                                    <a id="closeAccount"  class="nav-link text-dark" href="#closeAccount"><i class="fa-solid fa-trash m-2"></i>Close Account</a>

                                    <a  class="nav-link text-dark" href="/au/singout"><i class="fa-solid fa-power-off m-2"></i></i>Sign Out</a>
                                    
                                  
                                   
                             
                        </div>
                    </div>
</div>




  <div id="personalInfos"  class="col-md-9">


    

<div class="col-md-6">

    <div class="card p-2">
      <div class="card-body">
          <h4 class="card-title">Profile Details</h4>
          
          <p class="card-text">You have full control to manage your account setting.</p>
    </div>

      <form id="formFile"  method="post" enctype="multipart/form-data">
        <label>
          <div>
            <input type="file" name="avatar" id="file" style="display: none;">
            <img id="avatar" width="50px" class="rounded " src="/image/parent/<%=info[0].avatar%>" alt="">
            <center> <span id="fileEdit" class="btn btn-dark rounded-pill p-1 m-0">edit</span></center>
          </div>
        </label>
       </form>

       <h4 class="text-dark mt-3"><%-info[0].name %> </h4>
       <p class="text-dark mt-3"><%-info[0].email %> </p>
   <p class="text-muted">PNG or JPG and max file size 2mb.</p>

  </div>

</div>


<form action="/parent/info/update" method="post">

<div class="row">



<div class="col-md-6 col-10 m-auto m-md-0 shadow">


<label  for="name">Name</label>
<input class="form-dev " type="text" value="<%=info[0].name%>" name="name"  id="name" placeholder="Enter Name" required>
<p></p>

<div>
  <label for="male"> <span class="btn btn-light shadow"><input class="form-check-input " type="radio" id="male" value="Male" <%=info[0].gender=='Male' || info[0].gender=='male' ? 'checked': 'no'%>  name="gender" > Male </span> </label> 
  <label for="female">  <span class="btn btn-light shadow"><input class="form-check-input " type="radio" value="Female" id="female" <%=info[0].gender=='Female' || info[0].gender=='female'? 'checked': 'no'%>  name="gender" > Female </span> </label>
</div>

<label  for="">Contact</label>
<input class="form-dev " type="tel" value="<%=info[0].telephone%>" name="telephone"  id="" placeholder="Contact No" required>
<p></p>


     
<label for="">Student Id</label>
<input readonly disabled type="number"class="form-dev " value="<%=info[0].student_id%>" name="student_id" id="" placeholder="Student Id" required>
<p></p>


<label for="">Relation With Student</label>
<select class="form-dev " name="relation" id="" required>

  <option value="Father">Father</option>
  <option value="Monther">Monther</option>
  <option value="Brother">Brother</option>
  <option value="Sister">Sister</option>
  <option value="Grand Father">Grand Father</option>
  <option value="Grand Monther">Grand Mother</option>
  <option value="Others">Others</option>
  <option selected value="<%=info[0].relation%>"><%=info[0].relation%></option>


  </select>      
<p></p>


<center>
    <button class=" btn-dev w-50">Save Change</button>
    </center>
         </div>


         </div>
       

<p></p>



</div>


</form>
                


             

<div id="securitys"  class="col-md-9">

    
    <div class="row">
                     
        <div class="col-md-6">
          <div class="card">
            <div class="card-body">
                <h4 class="card-title">Security </h4>
                <p class="card-text text-muted">Edit your account settings your password here.</p>
            
                <hr>
            <p></p>
            <form action="/parent/email/update/page" method="post">
                <h4 class="card-title">Email address</h4>
                <p class="card-text">Your current email address is <a class="nav-item " style="text-decoration:none; color: rgb(82, 187, 129);" href="#"><%=info[0].email%> </a></p>
             <p></p>
                <label for="email">New email address </label>
                <input class="form-dev " type="email" name="username"  id="newemail" placeholder="<%=info[0].email%>" required>
                <p></p>
                <button id="emailUpdate" style="color:rgb(255, 255, 255) ; background-color: blueviolet;" class="btn btn-outline-light">Update</button>
              <p></p>
                <hr>
              <p></p>
             
            </form>

              <form id="passwordUpdateForm" action="/parent/password/update" method="post">

              
                <h4 class="card-title">Change Password</h4>
                <p class="card-text text-muted">We will email you a confirmation when changing your password,so please expect that email after submitting.</p>
             <p></p>
                <label for="password">Current Password</label>

                <div class="input-group">


                  <span class=" input-group-text"> <img width="30px" src="/icon/icons8-sign-in-form-password-48.png" alt=""> </span>
                  <input id="password" type="password" placeholder="********" name="pastPassword"  value="" class="form-control" required>
                  <span id="eye-hide" class="btn input-group-text"><i class="fa-sharp fa-solid fa-eye-slash"></i></span>
                  <span style="display: none;" id="eye-show" class="btn input-group-text"><i class="fa-sharp fa-solid fa-eye"></i></span>
      
  
              </div>
          
              <p></p>
              <label for="newpassword">New Password</label>
              <div class="input-group">


                <span class=" input-group-text"> <img width="30px" src="/icon/icons8-sign-in-form-password-48.png" alt=""> </span>
                <input id="password2" type="password" placeholder="********" name="password"  value="" class="form-control" required>
                <span id="eye-hide2" class="btn input-group-text"><i class="fa-sharp fa-solid fa-eye-slash"></i></span>
                <span style="display: none;" id="eye-show2" class="btn input-group-text"><i class="fa-sharp fa-solid fa-eye"></i></span>
    

            </div>
       <p></p>
              

                <button  style="color:rgb(255, 255, 255) ; background-color: blueviolet;" class="btn btn-outline-light">Save Change</button>
            <p></p>
                <p>Can't remember password? <a href="/au/forgot/password" style="color:blueviolet ;"> Reset password</a></p>

         </div>
</form>

                </div>
        </div>
      
          </div>




</div>



<div id="closeAccounts"  class="col-md-9 ">

    <div class="card " >
        <div class="card-body">
            <h5 class="card-title">Close your account</h5>
            <p class="card-text"> Close your account permanently.</p>
        </div>
    
                <hr>
        <div class="card-body">
            <h4 class="card-title text-danger">Warning</h4>
            <div class="card-text">If you close your account,you will be unsubscribed from all your 0 courses,and will lose access forever.</div>
            <br>
          
            <button data-id="<%=info[0].ID%>" class="defClose btn btn-outline-danger ">Close My Account</a>
            </div>
    </div>

                  
</div>


                
<!-- end mainDiv -->
</div>
   

<script>

$('#menuButton').on('click', ()=>{

     
$('#menuButton').html('&#9650;')




})

$('#eye-hide').click(()=>{
    $('#password').attr('type', "text")
    $('#eye-hide').css({'display': 'none'})
    $('#eye-show').css({'display': 'block'})
})


$('#eye-show').click(()=>{
    $('#password').attr('type', "password")
    $('#eye-hide').css({'display': 'block'})
    $('#eye-show').css({'display': 'none'})
})

$('#eye-hide2').click(()=>{
    $('#password2').attr('type', "text")
    $('#eye-hide2').css({'display': 'none'})
    $('#eye-show2').css({'display': 'block'})
})


$('#eye-show2').click(()=>{
    $('#password2').attr('type', "password")
    $('#eye-hide2').css({'display': 'block'})
    $('#eye-show2').css({'display': 'none'})
})


$("#emailUpdate").on("click", (e)=>{

let updatebtn=  e.currentTarget;

setTimeout(() => {
 
 $(updatebtn).addClass("disabled")

}, 2000);

})





$(document).on("click", ".nav-link", (e)=>{
  let navLink= e.currentTarget;
  $(".nav-link").removeClass("bg-active")
  $(navLink).addClass("bg-active")
})


$(document).on("click", ".defClose",()=>{
    $("#modal").click()
  })



$(document).on("click", ".defClose", (e)=>{

let dataID= e.currentTarget.attributes[0].value;



   $("#confirmed").on("click", ()=>{
    $.ajax({
        type: "post",
        url: "/parent/close/account",
        data: {dataID},
        dataType: "JSON",
        success: function (info) {
           window.location.replace("/au/singin/page")
            
        }
    });

   })


})


  



$("#file").on("change", ()=>{
  $("#formFile").submit()

})


$("#formFile").submit(function(e){

        e.preventDefault();

    var formdata = new FormData(this);

        $.ajax({
            url: "/parent/avatar/upload",
            type: "POST",
            data: formdata,
            mimeTypes:"multipart/form-data",
            contentType: false,
            cache: false,
            processData: false,
            beforeSend: function(){
              $("#fileEdit").hide()
             $("#avatar").addClass("spinner-grow")

            },

            success: function(info){

              $("#msg").text(info.msg)
                   toast_alive()

                setTimeout(() => {
                  window.location.reload()
                }, 3000);

            },

         });

         
 
      })
      
    
     








$("#personalInfos").show()

    $("#menuButton").click(()=>{
        $("#menuItems").toggleClass("d-none")
                        
        })
        
        
        $("#personalInfos").show()
        $("#personalInfo").click(()=>{
            $(".col-md-9").hide()
                $("#personalInfos").show()
                
          
        })

        
        $("#security").click(()=>{
            $(".col-md-9").hide()
                $("#securitys").show()
            })
     

        
        $("#privacySetting").click(()=>{
          
            $(".col-md-9").hide()
                $("#privacySettings").show()
            })
       

        
        $("#socialLink").click(()=>{
      
            $(".col-md-9").hide()
                $("#socialLinks").show()
           
        })  
        
        
        $("#closeAccount").click(()=>{
      
            $(".col-md-9").hide()
                $("#closeAccounts").show()
           
        })

        
    </script>
    
</body>
</html>